estT = [2.34793023061828,-16.1889242034018;2.33471742346748,-14.3861360177809;2.32196339434276,-12.5833478321599;2.30746600871898,-10.7805596465390;2.28902313207100,-8.97777146091809;2.27241536752730,-7.17498327529717;2.25644989222009,-5.37219508967625;2.23718121512519,-3.56940690405533;2.21626093713644,-1.76661871843441;2.19680874883110,0.0361694671865180;2.17671427128928,1.83895765280744;2.15391300339364,3.55980092090014;2.13221280276057,5.28064418899284;2.11012009203853,6.91954253955731;2.08817011225793,8.55844089012179;2.06963548000474,10.1973392406863;2.04753155470873,11.7542926737225;2.02331928950625,13.3112461067588;2.00178730748274,14.7862546222668;1.97989849810562,16.4251529728313;1.95905978065484,18.0640513233957;1.93820067306956,19.5390598389038;1.91465006773134,21.0140683544118;1.89379096014607,22.4890768699198;1.87191132632947,24.0460303029561;1.85061485035934,25.7668735710488;1.82773711945936,27.4057719216132;1.80676586613438,28.8807804371213;1.78500959263145,30.4377338701575;1.76372229222185,32.1585771382502;1.74151743576010,33.9613653238711;1.71940433490357,35.7641535094921;1.69719947844182,37.5669416951130;1.67582042242700,39.3697298807339;1.65673525654253,41.1725180663548;1.63627375657984,42.9753062519757;1.61645454585366,44.7780944375967;1.59810342481089,46.5808826232176;1.58204619389847,48.3836708088385;1.56562194056520,50.1864589944594;1.54818837557457,51.9892471800804;1.53323221192472,53.7920353657013;1.52066169401042,55.5948235513222;1.50616430838664,57.3976117369431;1.49129990034200,59.2003999225640;1.47854587121728,61.0031881081850;1.46680115374991,62.8059762938059;1.45634101475553,64.6087644794268;1.44514683091944,66.4115526650477;1.43404440268857,68.2143408506687;1.42569464261411,70.0171290362896;1.41606030406666,71.8199172219105;1.40844458883391,73.6227054075314;1.39780093862911,75.4254935931523;1.38945117855465,77.2282817787733;1.38330355300533,79.0310699643942;1.37596310458822,80.8338581500151;1.36843914496069,82.6366463356360;1.36128220775401,84.4394345212570;1.35834602838716,86.2422227068779;1.35201489162741,88.0450108924988;1.34678482213022,89.8477990781197;1.34146299702782,91.6505872637406;1.33531537147849,93.4533754493616;1.33210392529601,95.2561636349825;1.32834194548224,97.0589518206034;1.32256134235377,98.8617400062243;1.31870760693479,100.664528191845;1.31577142756795,102.467316377466;1.31210120335940,104.270104563087;1.30815571233520,106.072892748708;1.30457724373186,107.875680934329;1.30365968767972,109.678469119950;1.29998946347117,111.481257305571;1.29650275047305,113.284045491192;1.29475939397398,115.086833676813;1.29246550384364,116.889621862434;1.29007985810808,118.692410048054];
M = readmatrix ('scarica2811n4.csv');

h = M(:,1);
m = M(:,2);
s = M(:,3);
ts = M(:,4);
curr = M(:,5);
volt = M(:,6);
Tener = M(:,7);
% Temp1 = M(:,8);
% Temp2 = M(:,9);

i = 1;
sz = size(h);
time = [];
while(i <= sz(1))
    s(i) = s(i)+ts(i);
    
    if  s(i) >= 60
        s(i) = s(i)-60;
        m(i) = m(i)+1;
    end
    if m(i) >= 60
        m(i) = m(i)-60;
        h(i) = h(i)+1;
    end
    
    time(i, 1) = h(i);
    time(i, 2) = m(i);
    time(i, 3) = s(i);
    
    Tener(i,1) = interp1(estT(:, 1), estT(:,2), Tener(i,1), 'linear');
    
    i = i+1;
end

A = [time, curr, volt, Tener];
writematrix(A, '11_28_n4.csv', 'Delimiter', ';');